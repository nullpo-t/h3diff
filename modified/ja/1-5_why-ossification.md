## 硬直化

インターネットは「ネットワーク同士のネットワーク」です。
これを想定通りに動作させるため、インターネット上の実に様々な場所に機器が設置されています。
ネットワーク上に散りばめられたこれらの機器をミドルボックスと呼びます。
端末間のあちこちに存在するミドルボックスが、古くからネットワーク上のデータ転送に強く関わっています。

ミドルボックスは様々な目的で様々な動作をしていますが、それらはインターネットを正しく動作させるために必要だと誰かが考えた結果設置されたものと広く捉えることができます。
ミドルボックスはネットワーク間でIPパケットのルーティングを行ったり、悪意のあるトラフィックをブロックしたり、
NAT（Network Address Translation）を行ったり、パフォーマンスを向上させたり、通過するトラフィックを監視したり、またこれら以外にも様々なことを行います。

これらの役割を担うため、ミドルボックスはネットワークの構造や、監視・管理対象プロトコルの詳細を知る必要があります。
そのためにミドルボックスはソフトウェアを実行しますが、これらのソフトウェアは必ずしも頻繁にアップデートされるとは限りません。

<!--
ミドルボックスはインターネットを維持するための接着剤の役割を果たしますが、最新技術に追従できていないこともよくあります。
-->
一般的に、ミドルボックスは末端の機器ほどすぐには変化しません。
ミドルボックスに分析され、通信の可否を決定されるネットワークプロトコルはすべて、**ミドルボックスは自身が設置された時点のプロトコルの仕様に従って動作する**という問題を抱えます。
新しい仕様の追加や振る舞いの変化は、ミドルボックスに不具合や不正とみなさるリスクになってしまいます。
そのようなトラフィックは、単に捨てられたり、あるいはその機能を使用したくないと思うほど遅延させられたりします。
このような状況は「プロトコルの硬直化」と呼ばれます。

TCPも硬直化によって変化が難しい状況にあります。
クライアントとサーバーの間にある機器が、新しいTCPのオプションを不明なものとしてブロックするかもしれません。
プロトコルの詳細が分析できると、それを取り巻くシステムはプロトコルの通常の振る舞いを学習していき、やがてはプロトコルの変更を不可能にしてしまいます。
この硬直化と「戦う」ための真に効果的な唯一の方法は、可能な限り通信を暗号化し、ミドルボックスに通過するプロトコルの詳細を観察させないようにすることです。
